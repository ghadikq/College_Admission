---
title: "College_Admission_Report"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
#RQ what the important factors to get admitted in collage ?
#can we predict if the student will be admmited ?

```{r}
library(rsample)
library(caret)
library(tidyverse)

# import dataset
coladm <- read.csv("C:\\Users\\ghadi\\Documents\\DataSet\\College_admission.csv")

```
# make sure data is tidy
```{r}
coladm <- drop_na(coladm)
```
#exploratory data analysis
```{r}
dim(coladm)
names(coladm)
head(coladm)
cor(coladm)
```
#plot gre,admit to see their relation 
```{r}
ggplot(coladm, aes(gre, admit)) +
  geom_jitter(width = 0.2)
```
#plot gpa,gre to see their relation 
```{r}
ggplot(coladm, aes(x=gpa, y=gre)) +
  geom_point(size=3, shape=1)
```

#Supervised Modeling Process

```{r}
# 1. stratified sampling with the rsample package
set.seed(123)
split  <- initial_split(coladm, prop = 0.7, strata = "admit")
coladm_train  <- training(split)
coladm_test   <- testing(split)
```

```{r}

# 2. create a resampling method
cv <- trainControl(
  method = "repeatedcv", 
  number = 10, 
  repeats = 5
  )
```

```{r}

# 3. create a hyperparameter grid search
hyper_grid <- expand.grid(k = seq(2, 26, by = 2))
```

```{r}

# 4. execute grid search with knn model
#    use RMSE as preferred metric
knn_fit <- train(
  admit ~ ., 
  data = coladm_train, 
  method = "knn", 
  trControl = cv, 
  tuneGrid = hyper_grid,
  metric = "RMSE"
  )
```

```{r}

# 5. evaluate results
# print model results
knn_fit
# plot cross validation results
ggplot(knn_fit$results, aes(k, RMSE)) + 
  geom_line() +
  geom_point() +
  scale_y_continuous()
```

```{r}
# Do the distributions line up? 
ggplot(coladm_train, aes(x = admit)) + 
  geom_line(stat = "density", 
            trim = TRUE) + 
  geom_line(data = coladm_test, 
            stat = "density", 
            trim = TRUE, col = "red")
```




```{r}
# log transformation
coladm_recipe <- recipe(admit ~ ., data = coladm_train) %>%
  step_log(all_outcomes())

coladm_recipe
```


















